<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-04-11 Tue 06:10 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Day 9: Capturing the Notion of Parametricity</title>
<meta name="author" content="um" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel='stylesheet' href='/static/css/style.css' type='text/css'/>
</head>
<body>
<div id="preamble" class="status">
<h1 class='title'>
    <a href='/index.html'>
      <img id='banner' src='/static/img/logo.svg'
           alt='Synechist-trichotomic logo. Designed by Shon Feder'/>
      <span class='title-text'>Synechepedia</span>
    </a>
   </h1>
<div class='nav'>
<ul>
</ul>
</div>
</div>
<div id="content" class="content">
<h1 class="title">Day 9: Capturing the Notion of Parametricity</h1>
<p>
Today was spent implementing <i>System F</i>, also known as the <i>polymorphic lambda
calculus</i>, or λ2. I am studying System F as a prerequisite for a solid grasp of
System Fω, which is itself a prerequisite for moving forward with my planned
work on 1ML. My studies today turned up an interesting clue connecting the
original motive driving Reynolds&rsquo; work on the polymorphic lambda calculus with
the pursuit of modularity. The latter has been one of the driving urges of my
life for at least a decade, and it is at the root of my interest in 1ML. I have
made some notes in this entry recording what I learned. (I expect I will
eventually end up reworking and incorporating them into my WIP <a href="file:///home/sf/Dropbox/synechepedia/org/themata/programming/the-measure-of-a-module.html">notes on
modularity</a>).
</p>

<div id="outline-container-org2a2015c" class="outline-2">
<h2 id="org2a2015c">A few notes on the history of System F</h2>
<div class="outline-text-2" id="text-org2a2015c">
<p>
Jean-Yves Girard first defined System F in his PhD thesis in 1972. Writting
about that work around 2010, Girard characterized the calculus thus:
</p>

<blockquote>
<p>
System <b>F</b>, contrary to simply typed λ-calculus, is constructed <i>around</i>
Curry-Howard, as the isomorphic image of intuitionistic second-order
<i>propositional</i> calculus.
</p>

<p>
(<a href="girard11">girard11</a>)
</p>
</blockquote>

<p>
Two years later, Reynolds would introduce the same formalism with slightly
different aspect and the explicitly computational aim of developing a theory of
the &ldquo;type structure of programming languages&rdquo;<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>. According to Nederpelt and
Geuvers,
</p>

<blockquote>
<p>
Independent of Girard, J.C. Reynolds invented a similar typed lambda calculus
that he called the <i>polymorphic lambda calculus</i>. He constructed this system in
order to capture the notion of <i>parametricity</i>.
</p>

<p>
(<a href="rob2014type">rob2014type</a>)
</p>
</blockquote>

<p>
λ2 &ldquo;captures the notion of parametricity&rdquo; in a way that is immanent to the
syntax of the calculus itself: it enables polymorphic functions by extending the
simply typed lambda calculus with an additional abstraction mechanism for
building <i>functions of types</i> that return <i>terms</i>. This augments the simply
typed lambda calculus&rsquo; <b>terms that depend on terms</b> with <b>terms that depend on
types</b>.
</p>

<p>
Consider the identity function on integers:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">int_id</span> :<span class="org-type"> int -&gt; int </span>= <span class="org-keyword">fun</span> <span class="org-variable-name">x</span> -&gt; x
</pre>
</div>

<p>
λ2 allows parameterizing such functions by including functions that can take a
type as an argument, returning expressions whose types may depend on the type
parameter supplied. We can depict this in the pseudo OCaml below (which is quite
close to valid <a href="file:///home/sf/Dropbox/synechepedia/org/themata/programming/notes-on-1ml.html">1ML</a>):
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">id</span> (<span class="org-variable-name">t</span> :<span class="org-type"> type</span>) :<span class="org-type"> t -&gt; t </span>= <span class="org-keyword">fun</span> <span class="org-variable-name">x</span> -&gt; x
</pre>
</div>

<p>
This polymorphic <code>id</code> function takes a type <code>t</code> as an argument and returns an
identity function on values of that type. With this function in hand, can then
define any number of specialized id functions by supplying an appropriate type
as a parameter:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">int_id</span> :<span class="org-type"> int -&gt; int       </span>= id (int : <span class="org-keyword">type</span>)
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-variable-name">str_id</span> :<span class="org-type"> string -&gt; string </span>= id (string : <span class="org-keyword">type</span>)

<span class="org-comment-delimiter">(* </span><span class="org-comment">The identity function on functions of some parameterized type</span><span class="org-comment-delimiter"> *)</span>
<span class="org-tuareg-font-lock-governing">let</span> <span class="org-function-name">fun_id</span> (<span class="org-variable-name">t</span> :<span class="org-type"> type</span>) :<span class="org-type"> (t -&gt; t) -&gt; (t -&gt; t) </span>= id (t -&gt; <span class="org-tuareg-font-lock-label">t</span> : <span class="org-keyword">type</span>)
</pre>
</div>

<p>
Reynolds introduced λ2 in the 1974 paper &ldquo;Towards a theory of type structure&rdquo;
(<a href="reynolds74_towar">reynolds74_towar</a>). The innovation of polymorphic functions just explained
is described therein as a solution to &ldquo;the old but neglected problem of
polymorphic functions&rdquo;, but this problem is only given secondary importance. The
principle aim of the work is to formalize a theory of representation
independence for programs in order to ensure a program can maintain the seam
<i>meaning</i> regardless of the internal representation of its primitive types:
</p>

<blockquote>
<p>
We start with the belief that the meaning of syntactically valid program in a
&ldquo;type-correct&rdquo; language should never depend upon the particular representations
used to implement its primitive types.
</p>

<p>
&#x2026; this property of reference independence should hold for user-defined types
as well as primitive types. The introduction of a user-defined type <code>t</code> should
partition a program into an &ldquo;outer&rdquo; region in which <code>t</code> behaves like a primitive
type and is manipulated by various primitive operations which are used but not
defined, and an &ldquo;inner&rdquo; region in which the representation of <code>t</code> is defined in
terms of other types, and the primitive operations on <code>t</code> are defined in terms
of this representation. We expect that the meaning of such a program will remain
unchanged if the inner region is altered by changing the representation of the
type and redfining its primitive operations in a consistent manner.
</p>

<p>
(<a href="reynolds74_towar">reynolds74_towar</a>)
</p>
</blockquote>

<p>
It seems to me that we can clearly recognize the reference independence and
encapsulation described here as questions of <b>modularity</b>. Modularity is
precisely what enables us to seal internal representations of types and expose
both primitive and user defined types in a consistent, &ldquo;outer&rdquo; interface. In
MLs, parametric modularity is also what enables us to maintain the meaning of a
program (or at least whatever invariants of the program we wish to enforce) even
when the &ldquo;inner region&rdquo; is altered by supplying different module inputs. This
makes it seems that the achievement of 1ML (which is to unify the core and
module languages of the ML family by elaborating the modules into System Fω) is
an advance that continues to radicalize and unfold the potential of λ2 in close
alignment with its primary objective and purpose.
</p>

<p>
More on this in the future&#x2026;
</p>
</div>
</div>

<div id="outline-container-orga145381" class="outline-2">
<h2 id="orga145381">Today&rsquo;s Progress</h2>
<div class="outline-text-2" id="text-orga145381">
<p>
Overall, I&rsquo;m pleased with my progress today. I completed my program for today,
as laid out in <a href="day-8.html">Day 8</a>. This is encouraging because it means I set realistic goals
and was able to stay on task. However, I was helped by the fact that some
scheduled socializing fell through&#x2026; so I may still need to tweak my
expectations around feasible output.
</p>
</div>

<div id="outline-container-org63a12f4" class="outline-3">
<h3 id="org63a12f4">PLT</h3>
<div class="outline-text-3" id="text-org63a12f4">
</div>
<div id="outline-container-org897b5af" class="outline-4">
<h4 id="org897b5af">Themis</h4>
<div class="outline-text-4" id="text-org897b5af">
</div>
<ul class="org-ul">
<li><a id="org848782b"></a>Parsing<br />
<div class="outline-text-5" id="text-org848782b">
<p>
I generalized the parser utility functions I was using for the simply typed
lambda calculus so that a new parser can be produced by providing all the
requisite parsing parts. This is what it now looks like to create parser
front-ends for the simply typed lambda calculus and λ2, respectively:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Simply_typed</span> = <span class="org-tuareg-font-lock-module">Make</span> (<span class="org-tuareg-font-lock-governing">struct</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Tokens</span> = <span class="org-tuareg-font-lock-module">Simple_token</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Lexer</span> = <span class="org-tuareg-font-lock-module">Simple_lexer</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Ast</span> = <span class="org-tuareg-font-lock-module">Simple.Term</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Parser</span> = <span class="org-tuareg-font-lock-module">Simple_parser</span>
  <span class="org-tuareg-font-lock-governing">end</span>)

<span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">L2</span> = <span class="org-tuareg-font-lock-module">Make</span> (<span class="org-tuareg-font-lock-governing">struct</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Tokens</span> = <span class="org-tuareg-font-lock-module">L2_token</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Lexer</span> = <span class="org-tuareg-font-lock-module">L2_lexer</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Ast</span> = <span class="org-tuareg-font-lock-module">L2.Term</span>
    <span class="org-tuareg-font-lock-governing">module</span> <span class="org-tuareg-font-lock-module">Parser</span> = <span class="org-tuareg-font-lock-module">L2_parser</span>
  <span class="org-tuareg-font-lock-governing">end</span>)
</pre>
</div>
</div>
</li>

<li><a id="org8b0a590"></a>Deriving<br />
<div class="outline-text-5" id="text-org8b0a590">
<p>
I refactored out and functorized the definition of a derivation, including
concepts like <i>statement</i>, <i>declaration</i>, <i>context</i>, and <i>judgment</i>, as defined
in <a href="rob2014type">rob2014type</a>.
</p>

<p>
The basic tools for working with a derivations in a calculi can now be generated
for use in an module defining derivation rules with
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span class="org-tuareg-font-lock-governing">include</span> <span class="org-tuareg-font-lock-module">Derivation.Make (Term) (Type)</span>
</pre>
</div>

<p>
where, as expected, <code>Term</code> and <code>Type</code> define the terms and types of the
calculus.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgc437461" class="outline-4">
<h4 id="orgc437461">λ2 / System F</h4>
<div class="outline-text-4" id="text-orgc437461">
<ul class="org-ul">
<li>Defined a parser using ocamllex and menhir</li>
<li>Wrote unit tests for the parser</li>
<li>Started writing the type checker</li>
<li>Finished reading Chapter 3 of <a href="rob2014type">rob2014type</a>, which presents λ2</li>
<li>Spent some time reading Girard and Reynolds, both very fun :)</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org48ddf0d" class="outline-3">
<h3 id="org48ddf0d">Tooling</h3>
<div class="outline-text-3" id="text-org48ddf0d">
<p>
I wrote some OCaml yas snippets, and am planning to expand this into a library
of usable snippets to expedite OCaml code construction. Today I added
</p>

<ul class="org-ul">
<li>module declarations</li>
<li><code>let foo = function | pattern -&gt; exp</code> constructs</li>
</ul>
</div>
</div>

<div id="outline-container-orge0737f6" class="outline-3">
<h3 id="orge0737f6">Category Theory</h3>
<div class="outline-text-3" id="text-orge0737f6">
<p>
The category theory reading group met to agree on a schedule, a text, and a pace
today. That&rsquo;s great progress :)
</p>
</div>
</div>
</div>

<div id="outline-container-org5effa51" class="outline-2">
<h2 id="org5effa51">Tomorrow&rsquo;s Program</h2>
<div class="outline-text-2" id="text-org5effa51">
</div>
<div id="outline-container-org5fb5507" class="outline-3">
<h3 id="org5fb5507">PLT</h3>
<div class="outline-text-3" id="text-org5fb5507">
<ul class="org-ul">
<li>Finish implementing λ2</li>
<li>Read Chapter 4 of <a href="rob2014type">rob2014type</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgf024f03" class="outline-3">
<h3 id="orgf024f03">Community</h3>
<div class="outline-text-3" id="text-orgf024f03">
<ul class="org-ul">
<li>I have some pairing and coffee chats scheduled</li>
</ul>
</div>
</div>
<div id="outline-container-org1df70e9" class="outline-3">
<h3 id="org1df70e9">Writing</h3>
<div class="outline-text-3" id="text-org1df70e9">
<ul class="org-ul">
<li>The remarks on System F and its history in Reynolds work in this post has been
helpful in maturing my own burgeoning understanding, and it helped me catch
the thread of a deep connection between System F and modularity tracing right
back to its origin in Reynold&rsquo;s work.</li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
For reasons explained in <a href="day-6.html#org1b66621">Day 6</a>, and because my studies
here at the Recurse Center need to be skewed towards the practical, my current
reading around the topic is orbitting around Reynold&rsquo;s work rather than
Girard&rsquo;s.
</p>

<p class="footpara">
<a href="~/Dropbox/bibliography/references.bib">~/Dropbox/bibliography/references.bib</a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<div class='footer'>
Copyright 2019 Shon Feder.<br>
Last updated 2019-10-01 Tue 23:38. <br>
Built with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.6.1).
</div>
</div>
</body>
</html>